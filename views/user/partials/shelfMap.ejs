<div class="bg-white border border-gray-200 rounded-lg overflow-hidden shadow-sm">
    <div class="bg-gray-100 px-4 py-3 border-b flex justify-between items-center">
        <h3 class="font-bold text-gray-700 flex items-center">
            <i class="fas fa-map-marked-alt text-blue-600 mr-2"></i> Denah Rak
        </h3>
    </div>
    
    <div class="p-6 relative">
        <% 
            // Ambil shelfLocation dari parameter
            let shelfRaw = shelfLocation || 'A1'; // misal "Rak A1"
            // Hapus prefix "Rak " jika ada
            let shelf = shelfRaw.replace(/^Rak\s*/i, '').toUpperCase(); // hasil: "A1"

            const bookRack = shelf.charAt(0);      // huruf rak, misal "A"
            const bookFloor = shelf.slice(1);      // lantai, misal "1"

            const racks = ['A','B','C','D','E','F'];
            const topRow = racks.slice(0,3);       // A, B, C
            const bottomRow = racks.slice(3,6);    // D, E, F
        %>

        <h4 class="font-bold text-gray-700 mb-2">Lantai <%= bookFloor %></h4>

        <!-- Baris Atas -->
        <div class="grid grid-cols-3 gap-4 mb-4">
            <% topRow.forEach(rack => { 
                const rackId = rack + bookFloor;
                const isBookHere = (rackId === shelf);
            %>
                <div class="h-20 rounded-md flex items-center justify-center font-bold shadow-sm transition-all
                    <%= isBookHere 
                        ? 'bg-blue-600 text-white border-2 border-blue-700' 
                        : 'bg-gray-200 text-gray-500 border border-gray-300' %>">
                    <%= rackId %>
                </div>
            <% }) %>
        </div>

        <!-- Baris Bawah -->
        <div class="grid grid-cols-3 gap-4">
            <% bottomRow.forEach(rack => { 
                const rackId = rack + bookFloor;
                const isBookHere = (rackId === shelf);
            %>
                <div class="h-20 rounded-md flex items-center justify-center font-bold shadow-sm transition-all
                    <%= isBookHere 
                        ? 'bg-blue-600 text-white border-2 border-blue-700' 
                        : 'bg-gray-200 text-gray-500 border border-gray-300' %>">
                    <%= rackId %>
                </div>
            <% }) %>
        </div>
    </div>

    <div class="mt-2 text-xs text-gray-500 italic text-center">
        *Lokasi buku ditandai warna biru
    </div>
</div>